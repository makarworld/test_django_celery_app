Вакансия: https://spb.hh.ru/vacancy/128955079

# ТЗ
Собеседование
Добрый день.

Спасибо большое за отклик.
Меня зовут Яна, я project manager команды разработки Hello world.

Как и указали в вакансии мы ищем сотрудника в офис в Санкт-Петербурге. Если вас устраивает это условие, пожалуйста, создайте небольшой Django-проект, который демонстрирует следующее:

Модель: Создайте Django-модель Lesson (Урок) c полями на ваше усмотрение.

Бизнес-логика: Реализуйте механизм, который отслеживает важное событие в жизненном цикле урока — например, его создание или завершение.

Фоновая задача (Celery):
Когда это событие происходит, должна асинхронно запускаться задача Celery,
что будет имитировать отправку уведомления студенту (например, просто логировать сообщение: "Уведомление отправлено студенту [ID студента] по уроку [Название урока]").

Что предоставить: Ссылку на Git-репозиторий (GitHub/GitLab) с вашим решением. Краткий README.md с инструкциями по запуску (включая Celery) обязателен.

Что мы будем оценивать: Чистоту кода, обоснованность выбранного вами технического решения (почему вы выбрали именно этот способ отслеживания), корректную постановку задачи в Celery и следование лучшим практикам Django.

На всякий случай напоминаю условия работы:
- данная позиция только в офисе без удаленки или гибрида;
- оформление только по ТК РФ (ИП, самозанятость - не оформляем);
- офис находится на станции метро Василеостровская, 5 минут от метро спокойным шагом.

Если вдруг условия Вам не подходят, то не тратьте своё время на тестовое задание.

Этапы найма:
- тестовое задание, сейчас мы здесь;
- собеседование с тех лидом по итогам тестового задания;
- профориентационный тест;
- Финальное собеседование (обсуждение условий и получение офера).


# Информация о вакансии
Мы ищем опытного разработчика Django (Middle) для усиления нашей backend-команды. Вы будете отвечать за разработку нового функционала, поддержку существующих систем и обеспечение того, чтобы наши приложения были надежными, масштабируемыми и отказоустойчивыми. Эта роль идеально подходит для того, кому комфортно работать на всех этапах жизненного цикла разработки: от написания чистого кода и исчерпывающих тестов до развертывания и мониторинга приложений в production-среде.


Ключевые обязанности
Проектировать, создавать и поддерживать эффективный, переиспользуемый и надежный код с использованием Python и Django.
Разрабатывать и управлять сложными изменениями схемы базы данных с помощью миграций Django.

Внедрять и управлять асинхронными фоновыми задачами, используя Celery и Redis.

Писать надежные unit и интеграционные тесты с высоким покрытием, используя Pytest.

Создавать, управлять и оптимизировать наши пайплайны GitLab CI/CD для автоматизированного тестирования и развертывания.

Контейнеризировать приложения с помощью Docker и управлять сервисами с помощью Docker Compose.

Вносить вклад в наш стек наблюдаемости (observability) путем интеграции сервисов с Prometheus и создания дашбордов в Grafana.

Использовать сигналы Django для слабосвязанной (decoupled) обработки событий в приложении.

Взаимодействовать с front-end разработчиками, менеджерами продуктов и другими инженерами, используя Git (код-ревью, merge requests).

Устранять неисправности, отлаживать и обновлять существующие системы для обеспечения производительности и безопасности.

Требуемые квалификации
3-5+ лет профессионального опыта в backend-разработке на Python и Django.

Уверенный опыт работы с Celery и Redis: Вы создавали и управляли сложными очередями асинхронных задач.

Навыки тестирования: У вас есть твердое понимание Pytest, и вы считаете тестирование критически важным для качества кода.

DevOps и CI/CD: У вас есть практический опыт работы с GitLab CI/CD (или аналогичными, такими как Jenkins/GitHub Actions) и вы понимаете принципы непрерывной интеграции и доставки.

Контейнеризация: Вы уверенно владеете Docker и Docker Compose для локальной разработки и production-окружений.

Мониторинг: У вас есть практический опыт сбора метрик с помощью Prometheus и их визуализации в Grafana.

Навыки работы с БД: Вы глубоко понимаете Django ORM и управление состоянием базы данных с помощью миграций.

Владение Git: Вы в высшей степени комфортно работаете с Git, включая ветвление, слияние и разрешение конфликтов.

Знание Django: У вас есть хорошие рабочие знания таких концепций, как сигналы Django.

Проактивный подход к решению проблем и сильные коммуникативные навыки.

Как будет происходить отбор:
Тестовое задание
Собеседование с Tech Lead и Product и Project manager
Финальное собеседование для обсуждения условий трудоустройства

Для отклика на вакансию отправьте свое резюме.

---

## Проект: отслеживание жизненного цикла урока + Celery

Небольшой демонстрационный сервис на Django 5.1 и Celery 5.3. Сигналы Django запускают Celery-задачу при создании урока и при смене статуса на `completed`. Брокер/бэкенд по умолчанию — Redis.

### Краткая структура
- `manage.py` — точка входа Django.
- `config/` — настройки Django + Celery (`celery.py`).
- `lessons/` — модель `Lesson`, сигналы (`signals.py`), Celery-задача (`tasks.py`), миграция `0001`.
- `docker-compose.yml`, `Dockerfile` — контейнеризация + воркер.
- `env.example` — пример переменных окружения.

### Запуск локально (без Docker)
1. Создать окружение и установить зависимости:
   - Windows: `python -m venv .venv && .venv\Scripts\activate`
   - Linux/macOS: `python -m venv .venv && source .venv/bin/activate`
   - Затем: `pip install -r requirements.txt`
2. Скопировать переменные: `copy env.example .env` (Windows) или `cp env.example .env`.
3. При первом запуске выполнить миграции: `python manage.py migrate`.
4. Запустить Redis (вариант Docker): `docker run -p 6379:6379 redis:7-alpine`.
5. Запустить Celery-воркер: `celery -A config worker -l info`.
6. Запустить Django: `python manage.py runserver 8000`.
7. (Опционально) Создать суперпользователя для админки: `python manage.py createsuperuser`.

> Если `DEBUG=True`, по умолчанию `CELERY_TASK_ALWAYS_EAGER=True` — задачи выполняются синхронно без брокера. Для реальной асинхронности установите в `.env` значение `False` и поднимите Redis + воркер.

### Запуск через Docker Compose
1. Скопировать переменные: `cp env.example .env`.
2. `docker compose up --build`
   - `web`: применит миграции и запустит сервер на `8000`.
   - `worker`: Celery-воркер, использующий тот же образ и код.
   - `redis`: брокер/бэкенд.

### Что проверить
- Создание урока в админке вызывает задачу `send_lesson_notification`.
- Смена статуса урока на `completed` повторно отправляет задачу.
- Логи Celery содержат сообщение: `Уведомление отправлено студенту ...`.

### Бизнес-логика и техническое решение
- События: `created` и переход статуса в `completed` фиксируются через сигналы `pre_save`/`post_save` (`lessons/signals.py`).
- Сигналы выбраны для слабой связности: модель не знает о способе доставки уведомлений, а Celery-воркер можно масштабировать независимо.
- Задача `send_lesson_notification` (`lessons/tasks.py`) помечена `autoretry_for` и `retry_backoff=True` для простого экспоненциального ретрая.
- В тестах `lessons/tests.py` патчим `send_lesson_notification.delay`, чтобы проверить корректное срабатывание событий без реального брокера.

### Точки конфигурации
- `CELERY_BROKER_URL`, `CELERY_RESULT_BACKEND` — адрес Redis (по умолчанию `redis://localhost:6379/0`).
- `CELERY_TASK_ALWAYS_EAGER`, `CELERY_TASK_EAGER_PROPAGATES` — удобно держать `True` в DEV, `False` в PROD.
- `ALLOWED_HOSTS` — список хостов через запятую.

### Полезные команды
- `python manage.py test` — прогон тестов.
- `celery -A config worker -l info` — запуск воркера.
- `celery -A config beat -l info` — если понадобится планировщик (beat) для будущих задач.
